<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1' />
    <title>Jeff Lindsay</title>
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/blog/atom.xml" />
    <link rel="shortcut icon" type="image/x-icon" href="/images/JeffLindsayDeluxe.png" />
    <link href='http://fonts.googleapis.com/css?family=Dosis:400,300,700' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Roboto+Condensed:400,300,700' rel='stylesheet' type='text/css'>
    <link href="/stylesheets/all.css" rel="stylesheet" type="text/css" />
  </head>
  <body>
  <div id="wrapper">
    
    <header>
      <div class="container clearfix">
        <h1 id="logo">
          <a href="/">Progrium <span>// Jeff Lindsay</span></a>
        </h1>
        <nav>
          <a href="/about">About</a>
          <a href="http://github.com/progrium">Projects</a>
          <a href="/blog">Blog</a>
          <a class="hire" href="mailto:progrium+hire@gmail.com">HIRE ME</a>
        </nav>
      </div>
    </header>
    
    <main id="main" role="main">
      <section>
<div class="container">
    <div class="row">
        <div class="col-lg-9"> 
          <article>
            <div class="meta">
                <div class="date">
                    <span class="month">Dec</span>
                    <span class="day">15</span>
                    <span class="year">2012</span>
                </div>
            </div>
            <h1><a href="/blog/2012/12/15/avoiding-environmental-fallacy-with-systems-thinking/">Avoiding environmental fallacy with systems thinking</a></h1>
            <p>In 1905, German chemist Alfred Einhorn invented Novocaine to be used by doctors in surgery as a general anesthetic. Unfortunately, doctors didn't find Novocaine to be a suitable general anesthetic. However, dentists were dying to use it as a <em>local</em> anesthetic. The inventor didn't want to sell it for the "mundane purpose" of drilling teeth, so he continued marketing to doctors and surgeons. Einhorn persisted until his death, unwilling to let the market dictate the use of his invention. He felt the intrinsic value of Novocaine as a general anesthetic was enough to sell it as such, no matter what extrinsic value was placed on it by actual market demands. Charles West Churchman would call this an "environmental fallacy."</p>

<p>Environmental fallacy is the blunder of ignoring or not understanding the effects of the environment of a system. Examples of this fallacy are all around us. Anti-drug legislation fails to see long-term, societal implications because they're preoccupied by the immediate, localized problems. Efforts to improve a standardized public education are precisely and meticulously solving the wrong problem. Silicon Valley startups spend our brightest intellectual resources on photo sharing and social-whatever, while industries that affect the quality of living for millions are left with bureaucrats.</p>

<p>One could describe these all as failing to see the bigger picture. In systems we call this the environment of a system. The significance of which is governed by the principle of openness.</p>

<p>Openness is the principle that open systems, which includes everything from problems to corporations to opinions to products, can only be understood in the context of their environment. This is because open systems are dependent on and co-determined by their context. A closed system, like a watch or a hammer, can function entirely based on its own internal structure and process. An open system interacts with and is inextricably linked with its environment.</p>

<center><img src="/images/content/environmental-fallacy/open_vs_closed_sys.png" title="Open systems vs Closed systems" /></center>

<p>This insight may seem banal. In fact, the younger generations and the progressive recent generations are quite familiar with this concept at least as a vague intuition. But this is a very recent development. We don't appreciate how little this idea was understood for basically all of human existence up until just a few decades ago. </p>

<p>Science, for example. Science is our greatest effort to understand our objective reality. Like any other open system, it was defined and limited by the context of its time. As modern science began to develop 350 years ago, it was based on a worldview that denied the principle of openness. Most subjects were studied as closed systems.</p>

<p>For the greater part of its life, science has only understood the environment as something to be minimized. This is best shown in laboratories, a symbol of scientific activity, which are specifically designed to exclude the environment. Based on the doctrines of determinism and reductionism, science up until the last 4 or 5 decades has ignored the environment in favor of reductionist explanations focused on internal determinism. At best this only partially describes most actual phenomenon. For example, Galileo's equations for freely falling bodies completely ignore air resistance and the rotation of Earth, and Ohm's law assumes there will be no dramatic change in surrounding temperature. In both cases, the assumption is no environment.</p>

<p>This understated handicap of traditional science ended up as the major dilemma in the 1992 film Medicine Man. Sean Connery's character finds a miracle cure for cancer in a flower, but in the lab he's unable to reproduce it. He eventually finds out the flower itself was not the cure, but that the cure was produced by the flower interacting with another element in its environment. The unintentional moral of the story is about the significance of environment and environmental fallacy.</p>

<p>Only until ecology took off in the mid-20th century did we have a science that explicitly observed the environment, though primarily as a subset of biology. In many ways, ecology was a precursor to systems sciences. The difference between an ecological environment and the environment of a system is that a system environment is more general. It can be used to talk about physical environments, but also abstract environments, such as decision-making and problem-solving environments.</p>

<p>Often the environment refers to all external variables and conditions of a system, but in some cases it might refer to a particular part of the total environment. This is because the environment represents any surrounding system. Any one open system is embedded in a greater system, embedded in an even greater system, and so on. For example, one slice of how nested environments can affect an individual at work might look like this:</p>

<p><img src="/images/content/environmental-fallacy/nested_environments.png" title="Nested environments" style="float: left;" /></p>

<p>If all of these layers influence each other, you start to realize, maybe somewhat helplessly, that everything depends on everything else. No wonder science originally dismissed the environment. But ignoring the complexities and dynamics of open systems leads to sometimes serious disparities from reality. </p>

<p>In 1850, which for historical context was when California became a state and the US got its 13th president, the leading scientists of the western world convened for a conference in Europe. They actually concluded that in just 50 years, through science, they would have a complete understanding of the universe. This absurd notion stemmed from the foundations of scientific thought, which been tremendously useful, but also severely limiting. Only after the Heisenberg principle in the late 1920's have we begun to accept that reality is just too complicated to fully understand at once.</p>

<p>Ironically, admitting this has been beneficial to our grasp of reality. It's helped us realize new frameworks for thinking and coping with our increasingly complex and interdependent world. Luckily, our world is so globalized and connected today that modern generations are growing up with this reality as a daily experience. Systems theory and systems thinking are tools that can keep the appreciation of openness and the defining power of context as a first class tenet in all our endeavors. </p>

          </article>
          <a href="/blog/2012/12/15/avoiding-environmental-fallacy-with-systems-thinking/#disqus_thread">Comments</a>
          <br /><br />
        </div>
        
        <div class="col-lg-3" id="sidebar">
    <img src="/images/jeffphoto.gif" id="photo" title="Jeff Lindsay" />
    <p>Jeff Lindsay is a design-minded software architect and product engineer in Austin, Texas. Currently he consults and writes open source software focusing on next-gen platforms and infrastructure.</p>
    <h5><a href="http://twitter.com/progrium"><i class="fa fa-twitter-square fa-2x"></i>Twitter</a></h5>
    <h5><a href="http://github.com/progrium"><i class="fa fa-github fa-2x"></i>Github</a></h5>
    <h5><a href="http://linkedin.com/in/progrium"><i class="fa fa-linkedin-square fa-2x"></i>LinkedIn</a></h5>
    <h5><a href="http://gittip.com/progrium"><i class="fa fa-gittip fa-2x"></i>Gittip</a></h5>
</div>
    </div>
</div>
</section>


<section  class="alternate">
<div class="container">
    <div class="row">
        <div class="col-lg-9"> 
          <article>
            <div class="meta">
                <div class="date">
                    <span class="month">Dec</span>
                    <span class="day">06</span>
                    <span class="year">2012</span>
                </div>
            </div>
            <h1><a href="/blog/2012/12/06/async-http-responses-with-response-redirection/">Async HTTP Responses with Response Redirection</a></h1>
            <p>What if you could perform any HTTP request, but get the response back via a webhook? This is the simple goal of Response Redirection, a simple micro-protocol for telling an HTTP server to send the response to a URL. Instead of returning the response in the connection created by the request, the response is returned in HTTP callback fashion.</p>

<p>The primary use case for this is handling HTTP responses that take longer than you would prefer to keep an open connection. As we build APIs that start interacting with the real world and human processes, you could expect operations that might take hours to days to complete. </p>

<h3 id="example-of-response-redirection">Example of Response Redirection</h3>

<p>Response Redirection is done by performing a regular HTTP request with two additions: a Pragma directive telling the server you want the response to be redirected, and a Callback to be used for the response.</p>

<pre><code class="highlight plaintext">GET /helloworld HTTP/1.1
Host: example.com
Pragma: redirect
Callback: &lt;http://server.com/callback&gt;; method="post"; rel="redirect"
</code></pre>

<p>The response to this is a 202 Accepted or an appropriate error code. 202 Accpted is the standard response to give for operations that have been accepted and will be processed or finished later. As soon as the server as processed the request and has rendered a response, it would perform a request:</p>

<pre><code class="highlight plaintext">POST /callback HTTP/1.1
Host: server.com
Status: 200 OK
Content-Length: 11
Content-Type: text/plain

Hello world
</code></pre>

<p>As we talked about with the <a href="http://progrium.com/blog/2012/11/26/x-callback-header-an-evented-web-building-block/">Callback header</a>, if a <code>secret</code> parameter was given, it would imply that an HMAC signature be provided in the callback request. We'll revisit this again in another post. </p>

<p>If the server doesn't understand <code>Pragma: redirect</code>, it would return a normal response to the initial request and the client would have to handle it as usual.</p>

<h3 id="using-pragma">Using Pragma</h3>

<p>You'll notice we didn't invent a header to tell the server to we want to do Response Redirection. You may remember Pragma's original use was only for <code>Pragma: no-cache</code> and was eventually replaced with other cache control headers. However, the semantics of Pragma remain useful. To quote the <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.32">HTTP 1.1 spec</a>:</p>

<blockquote>
  <p>The Pragma general-header field is used to include implementation-specific directives that might apply to any recipient along the request/response chain.</p>
</blockquote>

<p>Another potential header field would be the <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.20">Expect header</a>. The Expect header is designed to let the client specify certain behaviors expected of the server. This would be perfect except for this property:</p>

<blockquote>
  <p>The Expect mechanism is hop-by-hop: that is, an HTTP/1.1 proxy MUST return a 417 (Expectation Failed) status if it receives a request with an expectation that it cannot meet.</p>
</blockquote>

<p>In today's world, this renders it useless unless we were talking about changing the behavior of proxies. The Pragma header was designed to be forwarded by proxies and ignored if it doesn't know how to fulfill the directive. </p>

<h3 id="alternate-implementation">Alternate Implementation</h3>

<p>In the discussion that followed the Callback header post, not only did we learn that the <code>X-</code> header prefix <a href="http://tools.ietf.org/html/rfc6648">is now deprecated</a>, but there is an RFC draft called <a href="http://tools.ietf.org/html/draft-snell-http-prefer-17">Prefer Header for HTTP</a>.</p>

<p>It actually addresses the issue with the Expect header, providing an alternative for specifying optional preferences for how the server handles a request. One of the example preferences is for returning the response asynchronously, which is exactly what we're achieving with Response Redirection. The only missing element is the callback, which we can easily include with our Callback header. Here we augment an example directly from the spec:</p>

<pre><code class="highlight plaintext">POST /collection HTTP/1.1
Host: example.org
Content-Type: text/plain
Prefer: respond-async
Callback: &lt;http://server.com/callback&gt;; rel="respond-async"

{Data}
</code></pre>

<p>The server would respond with 202 Accepted, just as we would have had with the Pragma implementation. It's up for discussion which implementation is ideal.</p>

<h3 id="last-thoughts">Last Thoughts</h3>

<p>Granted, there are likely better ways to approach the use case we described at the beginning. Creating a resource immediately and subscribing to state changes might actually be ideal. Perhaps the Response Redirection spec is purely academic. That brings us again to the idea of HTTP Subscriptions, which I'll get to posting about soon. </p>

<p>However, Response Redirection is a great example of a simple protocol built on top of the Callback header. The use of Prefer and Pragma will also set the stage for the design decisions of my initial informal draft of HTTP Subscriptions. It will continue this trend of reusing existing pieces of technology (Pragma, Expect, Prefer, Callback) as building blocks that, from my perspective, were intended to be re-combined to achieve new behavior.</p>

<p>Let me know what you think in the comments or in the <a href="https://groups.google.com/forum/#!forum/webhooks">Webhooks Google Group</a>.</p>

          </article>
          <a href="/blog/2012/12/06/async-http-responses-with-response-redirection/#disqus_thread">Comments</a>
        </div>
    </div>
</div>
</section>
<section >
<div class="container">
    <div class="row">
        <div class="col-lg-9"> 
          <article>
            <div class="meta">
                <div class="date">
                    <span class="month">Nov</span>
                    <span class="day">26</span>
                    <span class="year">2012</span>
                </div>
            </div>
            <h1><a href="/blog/2012/11/26/x-callback-header-an-evented-web-building-block/">X-Callback Header: Evented Web Building Block</a></h1>
            <div class="alert alert-info">
Since this posting, we decided to adopt "best current
practice" and drop the X- prefix as described in <a href="http://tools.ietf.org/html/rfc6648">RFC 6648</a>. Future posts refer to this as the Callback header.
</div>
<p>Webhooks is the simple concept of HTTP callbacks. It expands on the simple request/response model of HTTP, giving you the semantics of <a href="http://j.mp/10EitT8">callbacks in programming</a>. Request/response gives you one response for one request in one synchronous operation. It's like invoking a function and getting a return value. With callbacks, after you register a callback, the callback will receive one or more invocations, perhaps minutes or hours apart. </p>

<p>Callbacks are a necessary component of any evented or reactor-based system, like Node.js, Twisted, or EventMachine. So, naturally, HTTP callbacks are necessary to achieve <a href="http://progrium.com/blog/2012/11/19/from-webhooks-to-the-evented-web/">the Evented Web</a>.</p>

<p>Modeling callbacks in HTTP is somewhat straightforward. The callback is a URL. You perform an HTTP request against an application to register a callback URL. The application then performs an HTTP request to that URL to invoke that callback. </p>

<p>Those high-level requirements are enough to set anybody in the right direction to effectively implement webhooks or HTTP callbacks for their application. The problem is that now every application implements the specifics differently. While this is fine to provide a callback paradigm for each application, it doesn't let us <em>build</em> on this paradigm. The Evented Web needs to agree on some standards, and the X-Callback header is one of those standards.</p>

<h3 id="x-callback-header">X-Callback Header</h3>

<p>The X-Callback header is a proposal for a common way to describe HTTP callbacks, primarily in the case of registering them. It does not get into the specifics for different ways of using HTTP callbacks, so it's more of a building block for APIs or larger protocols such as HTTP Subscriptions, which I mentioned <a href="http://progrium.com/blog/2012/11/19/from-webhooks-to-the-evented-web/">in my previous post</a>.</p>

<p>Here's what it looks like to use X-Callback:</p>

<pre><code class="highlight plaintext">X-Callback: &lt;http://example.com/callback&gt;; method="post"
</code></pre>

<p>The format is directly borrowed from the <a href="http://www.w3.org/Protocols/9707-link-header.html">Link header</a> used for responses. You provide a URL and then optional key-value parameters. In the case above, the HTTP method for invoking the callback was specified as a parameter. </p>

<p>Here is a more formal description of the header:</p>

<pre><code class="highlight plaintext">X-Callback     = "X-Callback" ":" #("&lt;" URI "&gt;" *( ";" callback-param ) )
callback-param  = token [ "=" ( token | quoted-string ) ]
</code></pre>

<p>Since this is just the beginning of the conversation, there are no "built-in" callback parameters in this definition. They're effectively all extensions. However, these are what I'd propose for standard parameters:</p>

<ul>
  <li><strong>method</strong>: The HTTP method preferred for invoking this callback. Servers can ignore or override based on their policies, but this lets the requester optionally state preference.</li>
  <li><strong>secret</strong>: The secret to be used for signing callback requests. More on this in the next section.</li>
  <li><strong>rel</strong>: The relationship of this callback to this request, similar to the rel of the Link header. This lets you specify the role of this callback, which is useful when multiple callbacks are provided. It effectively lets you classify the callbacks.</li>
</ul>

<h3 id="authenticating-with-signatures">Authenticating with Signatures</h3>

<p>A common pattern across most implementations of webhooks has been the use of signatures for authenticating the callback "invocation" requests. Either built-in to the X-Callback header spec or maybe as a separate extension, a standard way of providing a secret then building and including a signature would be a Good Idea. The following is a proposal based on PubSubHubbub's signature model, but is not that different from the majority of implementations out there.</p>

<p>We start with a shared secret. Transmission of this secret can be done out of band (through a dashboard, for example), or the secret can be provided via the <em>secret</em> parameter of the X-Callback header during registration. </p>

<p>The secret can then be used with HMAC to sign anything. In the case of callbacks, it would sign the body of the callback request body. Since you can use different hashing techniques with HMAC, the technique used is specified along with a hexadecimal digest of the HMAC signature. This is put in the X-Signature header of requests:</p>

<pre><code class="highlight plaintext">X-Signature: sha1=0beec7b5ea3f0fdbc95d0dd47f3c5bc275da8a33
</code></pre>

<p>Now the callback handler can rebuild this signature knowing the secret and having the content body and the hash technique. Authenticating is then comparing the built signature with the one provided in the X-Signature header. </p>

<p>Signing lets the callback handler be more certain of the source without requiring SSL. Signatures become much less necessary if all requests are using HTTPS. But having this simple complement to X-Callback makes it easy when you need it, and may help unify all the different approaches that are all effectively doing the same thing.</p>

<h3 id="example-callback-flow">Example Callback Flow</h3>

<p>Let's use all this in an example, showing you the actual HTTP requests. First, we're going to register a callback at a particular endpoint:</p>

<pre><code class="highlight plaintext">POST /callbacks/register HTTP/1.1
Host: server-example.com
X-Callback: &lt;http://example.com/callback&gt;; method="post"; secret="opensesame"
Content-Length: 0
</code></pre>

<p>The server can respond however it likes since X-Callback header doesn't specify anything more than how to hand the server a callback. Let's assume it returned 200 OK. </p>

<p>Now, whenever it likes, the server is going to be performing an HTTP POST on the callback URL. Since a secret was provided, the server will be providing a signature using the X-Signature header. Here's what one of those requests might look like:</p>

<pre><code class="highlight plaintext">POST /callback HTTP/1.1
Host: example.com
Content-Type: application/json
Content-Length: 26
X-Signature: sha1=76afe1da675cf6d3d59c71a4af44dafc69fd03f0

{"payload": "Hello world"}
</code></pre>

<p>You'll notice we've stayed completely out of the content layer of HTTP. This is quite intentional. This gives implementors lots of flexibility and keeps this a "pure" extension to HTTP.</p>

<h3 id="a-building-block">A Building Block</h3>

<p>As I've mentioned, this header is intended to be used in APIs and protocols that use callbacks in different ways. The obvious example is HTTP Subscriptions, which will let you subscribe to events using HTTP callbacks. </p>

<p>Another example, which I'll also talk about soon, is HTTP Response Redirection. Regular <a href="http://en.wikipedia.org/wiki/URL_redirection#HTTP_status_codes_3xx">HTTP Redirection</a> lets the server redirect the client's request to another URL, whereas Response Redirection lets the client redirect where the server sends the response using an HTTP callback.</p>

<p>The X-Callback header is simple, focused, and content neutral. Hopefully this makes it a powerful building block for other technologies of the Evented Web.</p>

          </article>
          <a href="/blog/2012/11/26/x-callback-header-an-evented-web-building-block/#disqus_thread">Comments</a>
        </div>
    </div>
</div>
</section>
<section  class="alternate">
<div class="container">
    <div class="row">
        <div class="col-lg-9"> 
          <article>
            <div class="meta">
                <div class="date">
                    <span class="month">Nov</span>
                    <span class="day">19</span>
                    <span class="year">2012</span>
                </div>
            </div>
            <h1><a href="/blog/2012/11/19/from-webhooks-to-the-evented-web/">From Webhooks to the Evented Web</a></h1>
            <p>Back in 2007 I started thinking and talking a lot about <a href="http://progrium.com/blog/2007/05/03/web-hooks-to-revolutionize-the-web/">an idea called webhooks</a>. Over the following few years I started evangelizing it. I spent a lot of my free time giving talks and building tools around the idea of webhooks. Some of these tools are still around today, including <a href="http://localtunnel.com">Localtunnel</a> and <a href="http://requestb.in">RequestBin</a> (originally PostBin). There were others that might not be around anymore: <a href="http://mailhooks.com">MailHooks</a>, <a href="http://clickhooks.com">ClickHooks</a>, <a href="http://twitterhooks.com">TwitterHooks</a>, <a href="http://scriptlets.org">Scriptlets</a>, and a few others.</p>

<p>Webhooks wasn't really a new technology in the sense that there was a specification or tangible piece of software. It was more of an architectural pattern, and a loose one at that. To me it was just a different way to think about web applications, and it opened up a lot of new possibilities. </p>

<p>I was really excited by those possibilities, so I started telling people about it. The only problem was that it was this semi-vague idea. I often spoke in high-level notions. It was hard for some people to understand at the time. I think some people mostly got it, but a lot of people didn't get it and thought they did. </p>

<h3 id="confusion">Confusion</h3>

<p>For example, the name "webhooks" was more about the pattern than any specific part of how it works. Webhooks involve two parts: an application that triggers a URL, and a handler at that URL. If you were to ask "where is the webhook?" different people will answer you differently. Some say it's the trigger side. Some say it's the handler side. For me, "a webhook" is the combination of both a trigger and a handler.</p>

<p>It also didn't help that there was never a spec. I always avoided a spec because there were a lot of different implementations already out there, and you might implement it slightly different for different use cases. It made sense to me to just keep it a general pattern and not limit what was possible. </p>

<p>I didn't want to say, "Well, if you want to implement webhooks, it's got to be JSON. And use this payload structure. And this is the API for registering them. Otherwise, it's not webhooks." Because if you didn't do those things in a particular way, they'd still be webhooks to me. </p>

<h3 id="mild-success">Mild Success</h3>

<p>After a while, the idea got out there and companies like Google, Facebook, Wordpress, GitHub, Twilio, and other startups started implementing it. Five years later and I still often run into new applications or open source projects using the term webhooks. But even after all this time, there's still a lot of cool stuff that I wanted to emerge that hasn't really happened yet.</p>

<p>Some of it is starting to happen, though. For example, how do you write these handlers script? I really didn't believe in being able to just plug apps together like pipes. That's something that could come later and would definitely need a spec. Instead, I wanted people to actually write handler scripts with code. That way they could make something that did whatever they wanted, exactly how they wanted.</p>

<p>To facilitate that, I wanted a service that would let you write and it would host for you these little handler scripts for processing HTTP webhook requests. I actually built a prototype of this called Scriptlets. It was a web app where you could write JavaScript, hit save, and then you'd have a little script at a URL that you could use for webhooks.</p>

<p>Scriptlets didn't get very popular, though I didn't push it very hard. There was a lot I wanted to do with it but there wasn't enough demand to drive development, and I was so busy that it eventually became defunct. </p>

<p>Four years later, we actually have a service like this. I discovered it about a week ago. It's called <a href="http://webscript.io">Webscript</a>. It's basically Scriptlets done right. Webscript is a web app where you can write Lua, hit save, and then you've got little web service. It has basically everything you need to write webhook handler scripts.</p>

<h3 id="the-ecosystem">The Ecosystem</h3>

<p>Slowly, people <em>are</em> building out pieces of the ecosystem. You could say that the webhooks paradigm was really about this ecosystem. At some point I realized this and decided to give that ecosystem a name. It turned out the ecosystem was really what I was getting at with webhooks. That's where the magic was.</p>

<p>I started calling this ecosystem the Evented Web. Like the Semantic Web and "programmable web," it's an umbrella term for a family of technologies coupled with a vision of what the world could be like. The Evented Web envisions a world where the programmable web that we have today of traditional web APIs is complemented by APIs that produce events through webhooks. Adding a callback mechanism to web APIs makes the web more like a giant evented framework.</p>

<p>Just like with Node.js, perhaps the most popular evented framework, there's all kinds of innovation happening in the community. It's a new way of thinking about things. Pipes and streams come up a lot in the Node.js world now, and similar sorts of things can be done across web applications with an Evented Web.</p>

<p>By the time I started talking more about the Evented Web instead of just webhooks, I was already pretty tired of talking about it all. I was sort of "over it" and I started to not care if people didn't see or share this vision. I continued to think it was cool, but I started to move on to other interests.</p>

<h3 id="the-future">The Future</h3>

<p>These days, the people that really get it are starting to build some really neat things. Webhooks have spread enough that you can at least reference them or the idea of HTTP callbacks and not have to explain yourself. Now is maybe the perfect time for me to put a few specific projects into motion that could at least provide a tangible foundation for building out the Evented Web. Not just vague notions.</p>

<p>The most immediate thing is a lightweight spec for implementing webhooks. Specifically I mean registering a callback URL and invoking the callback URL. I've intentionally put this off for a lot of reasons. I didn't want to get it wrong. I didn't want to leave people out. I wanted to capture best practices, which for the longest time we hadn't them figured out. But now might be the perfect time because there is a lot on the verge of happening.</p>

<p>Stay tuned for my proposal for HTTP Subscriptions. It will be the first of several really cool developments for the Evented Web, from me and from others.</p>

          </article>
          <a href="/blog/2012/11/19/from-webhooks-to-the-evented-web/#disqus_thread">Comments</a>
        </div>
    </div>
</div>
</section>
<section >
<div class="container">
    <div class="row">
        <div class="col-lg-9"> 
          <article>
            <div class="meta">
                <div class="date">
                    <span class="month">Sep</span>
                    <span class="day">30</span>
                    <span class="year">2012</span>
                </div>
            </div>
            <h1><a href="/blog/2012/09/30/piping-into-and-out-of-the-cloud-with-skypipe/">Piping into and out of the cloud with skypipe</a></h1>
            <p><a href="https://github.com/progrium/skypipe">Skypipe</a> is a magical command line tool that lets you easily pipe data across terminal sessions regardless of whether the sessions are on the same machine, across thousands of machines, or even behind a firewall. It gives you named pipes in the sky and lets you pipe data <em>anywhere</em>. </p>

<p>I built it while on vacation the last couple months. I wasn't intending
to write software while on my trip, but I just couldn't help myself.</p>

<p>Skypipe is conceptually similar to named pipes or netcat, but with more power and a simpler interface. Here is a basic example using skypipe as you would a regular named pipe to gzip a file across shells:</p>

<pre><code class="highlight plaintext">$ skypipe | gzip -9 -c &gt; out.gz
</code></pre>

<p>Your skypipe is now ready to receive some data from another shell process:</p>

<pre><code class="highlight plaintext">$ cat file | skypipe
</code></pre>

<p>Unlike named pipes, however, <em>this will work across any machines connected to the Internet</em>. You don't have to specify a host address or set up "listen mode" like you would with netcat. In fact, unlike netcat, which is point to point, you could use skypipe for log aggregation. Here we'll used named skypipes. Run this on several hosts:</p>

<pre><code class="highlight plaintext">$ tail -f /var/log/somefile | skypipe logs
</code></pre>

<p>Then run this on a single machine:</p>

<pre><code class="highlight plaintext">$ skypipe logs &gt; /var/log/aggregate
</code></pre>

<p>This can also broadcast to multiple hosts. With the above, you can "listen in" by running this from your laptop, even while behind a NAT:</p>

<pre><code class="highlight plaintext">$ skypipe logs
</code></pre>

<p>You can also temporarily store data or files in the pipe, even several files, until you pull them out. On one machine load some files into a named skypipe:</p>

<pre><code class="highlight plaintext">$ cat file_a | skypipe files
$ cat file_b | skypipe files
</code></pre>

<p>Now, from somewhere else, pull them out in order:</p>

<pre><code class="highlight plaintext">$ skypipe files &gt; new_file_a
$ skypipe files &gt; new_file_b
</code></pre>

<p>Lastly, you can use skypipe like the channel primitive in Go for coordinating between shell scripts. As a simple example, we'll use skypipe to wait for an event triggered by another script:</p>

<pre><code class="highlight shell"><span class="c">#!/bin/bash</span>
<span class="nb">echo</span> <span class="s2">"I'm going to wait until triggered"</span>
skypipe trigger
<span class="nb">echo</span> <span class="s2">"I was triggered!"</span>
</code></pre>

<p>Triggering is just sending an EOF over the pipe, causing the listening skypipe to terminate. We can do this with a simple idiom:</p>

<pre><code class="highlight plaintext">$ echo | skypipe trigger
</code></pre>

<h3 id="how-does-this-magic-work">How does this magic work?</h3>

<p>You'll need a free <a href="https://www.dotcloud.com/">Dotcloud</a> account to use skypipe, but you don't need to know anything about using Dotcloud to use skypipe. </p>

<p>When you first use skypipe it will want you to run a setup command (<code>skypipe --setup</code>). This will deploy a very simple messaging server to Dotcloud. From then on, skypipe will use your account to transparently find and use this server, no matter where you are. The server is managed automatically and runs on Dotcloud free of charge, so you never need to think about it.</p>

<h3 id="software-with-a-service">Software with a service!</h3>

<p>This is a new paradigm of creating tools that transparently leverage the cloud to create magical experiences. It's not quite software as a service, it's software <em>with</em> a service. Nobody is using a shared, central server, and no one needs to setup or manage their own server. The <em>software</em> deploys and manages its own server for you.</p>

<p>Thanks to platforms like Heroku and Dotcloud, we can now build software leveraging features of software as a service that is <em>packaged and distributed like normal open source software</em>.</p>

<p>I'm excited to see what else can be done with this pattern. Naturally, I'm already thinking about a number of other potential uses.</p>

<h3 id="using-skypipe-and-getting-involved">Using skypipe and getting involved</h3>

<p>Skypipe is still an alpha piece of software. Be warned, there are some rough edges. That said, you can install skypipe with pip:</p>

<pre><code class="highlight plaintext">$ pip install skypipe
</code></pre>

<p>The user experience is not yet entirely optimized. One of the biggest issues is that it needs to check for the server on every use. This can be done less often and cached, which would make it much snappier and on par with most command line utilities. </p>

<p>This and a few other issues are already tracked in <a href="https://github.com/progrium/skypipe/issues">Github Issues</a>; feel free to take a whack at them. The codebase is intentionally small, documented, and written to be read, although there are no tests yet. </p>

<p>The project also depends on ZeroMQ, which requires a C extension to be compiled. Even using the pyzmq-static package, you still need certain header files (python.h at the very least) to install skypipe, and not every environment has these. Ideally, I'd like to find a way to package skypipe in a way that includes all its dependencies. Perhaps <a href="http://www.pyinstaller.org/">PyInstaller</a> can help with this.</p>

<p>Another feature I'm sure a lot of people will want (or complain about) is being able to run your own server and ignore the software with a service aspect. Since the server is packaged with the client, this is not far off from happening. Somebody just needs to make it happen. </p>

<p>Contribution ideas aside, I'm hoping skypipe will be useful to others besides myself. I was really going for a magical tool. I think a big part of this magic is the use of software with a service, which I consider a bit novel in itself. What do you think?  </p>

          </article>
          <a href="/blog/2012/09/30/piping-into-and-out-of-the-cloud-with-skypipe/#disqus_thread">Comments</a>
        </div>
    </div>
</div>
</section>


<section class="alternate">
<div class="container">
    <div class="row">
        <div class="col-lg-12"> 
        <ul class="pager article">
          <li class="previous">
            <a href="/blog/page4/">&larr; Older</a>
          </li>
        
          <li class="next">
            <a href="/blog/page2/">Newer &rarr;</a>
          </li>
        </ul>
        </div>
    </div>
</div>
</section>

    </main>
    
    <!--aside>
      <h2>Recent Articles?</h2>
      <ol>
          <li><a href="/blog/2014/07/25/building-the-future-with-docker/">Building the Future with Docker</a> <span>Jul 25</span></li>
          <li><a href="/blog/2014/07/01/beyond-flynn-or-flynn-as-a-worldview/">Beyond Flynn, or Flynn-as-a-Worldview</a> <span>Jul  1</span></li>
          <li><a href="/blog/2014/02/06/the-start-of-the-age-of-flynn/">The Start of the Age of Flynn</a> <span>Feb  6</span></li>
          <li><a href="/blog/2013/11/13/viewdocs-hosted-markdown-project-documentation/">Viewdocs: Hosted Markdown project documentation (finally!)</a> <span>Nov 13</span></li>
          <li><a href="/blog/2013/08/18/hacker-dojo-community-trading-zone/">Hacker Dojo: Community Trading Zone</a> <span>Aug 18</span></li>
          <li><a href="/blog/2013/06/19/dokku-the-smallest-paas-implementation-youve-ever-seen/">Dokku: The smallest PaaS implementation you've ever seen</a> <span>Jun 19</span></li>
          <li><a href="/blog/2013/01/05/executable-tweets-and-programs-in-short-urls/">Executable Tweets and Programs in Short URLs</a> <span>Jan  5</span></li>
          <li><a href="/blog/2013/01/01/where-did-localtunnel-come-from/">Where did Localtunnel come from?</a> <span>Jan  1</span></li>
          <li><a href="/blog/2012/12/25/localtunnel-v2-available-in-beta/">Localtunnel v2 available in beta</a> <span>Dec 25</span></li>
          <li><a href="/blog/2012/12/17/http-signatures-with-content-hmac/">HTTP Signatures with Content-HMAC</a> <span>Dec 17</span></li>
      </ol>

      <h2>Tags</h2>
      <ol>
      </ol>

      <h2>By Year</h2>
      <ol>
          <li><a href="/blog/2014/">2014 (3)</a></li>
          <li><a href="/blog/2013/">2013 (5)</a></li>
          <li><a href="/blog/2012/">2012 (8)</a></li>
          <li><a href="/blog/2010/">2010 (3)</a></li>
          <li><a href="/blog/2009/">2009 (5)</a></li>
          <li><a href="/blog/2007/">2007 (1)</a></li>
      </ol>
    </aside-->

    <footer>
      <div class="container clearfix">
        &copy; 2014 Jeff Lindsay, Progrium Labs
      </div>
    </footer>

  </div>
  <script src="/javascripts/all.js" type="text/javascript"></script>
  <script type="text/javascript">
        var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
        document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
        </script>
        <script type="text/javascript">
        try {
        var pageTracker = _gat._getTracker("UA-6824126-1");
        pageTracker._trackPageview();
        } catch(err) {}</script>
  </body>
</html>
